33333 tensor([80.], device='cuda:0') tensor([80.0258], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([0.0258], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.4638], device='cuda:0') tensor([80.0258], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([2.5621], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([78.4929], device='cuda:0') tensor([80.0258], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([1.5329], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([74.3693], device='cuda:0') tensor([80.0258], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([5.6565], device='cuda:0', grad_fn=<SubBackward0>)
epoch 0,  actor_loss: 76.5612,  critic_loss: 2956.0034, cost_time: 1.1271, best_solution: 0,od: 2.4486, eqity: 3.0231,rad: 23.7715
tensor(100, device='cuda:0') tensor([77.5815], device='cuda:0')
33333 tensor([79.2206], device='cuda:0') tensor([-93.1579], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-172.3785], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.3226], device='cuda:0') tensor([-93.1579], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-170.4805], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([78.3926], device='cuda:0') tensor([-93.1579], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-171.5505], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([75.0979], device='cuda:0') tensor([-93.1579], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-168.2558], device='cuda:0', grad_fn=<SubBackward0>)
epoch 1,  actor_loss: -4974.4199,  critic_loss: 9645533.0000, cost_time: 0.4254, best_solution: 0,od: 1.3852, eqity: 3.1145,rad: 9.0122
tensor([77.5815], device='cuda:0') tensor([77.5084], device='cuda:0')
33333 tensor([75.2947], device='cuda:0') tensor([152.9517], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([77.6570], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.2136], device='cuda:0') tensor([152.9517], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([75.7381], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([78.7845], device='cuda:0') tensor([152.9517], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([74.1672], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.2397], device='cuda:0') tensor([152.9517], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([73.7120], device='cuda:0', grad_fn=<SubBackward0>)
epoch 2,  actor_loss: 2119.4819,  critic_loss: 54348.3320, cost_time: 0.3950, best_solution: 0,od: 1.5052, eqity: 2.9586,rad: 14.9777
33333 tensor([79.7618], device='cuda:0') tensor([-30.1781], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-109.9399], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([76.6950], device='cuda:0') tensor([-30.1781], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-106.8731], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([76.0923], device='cuda:0') tensor([-30.1781], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-106.2704], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([74.7769], device='cuda:0') tensor([-30.1781], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-104.9550], device='cuda:0', grad_fn=<SubBackward0>)
epoch 3,  actor_loss: -3394.6680,  critic_loss: 1350038.7500, cost_time: 0.4212, best_solution: 0,od: 3.9358, eqity: 3.9606,rad: 27.7248
tensor([77.5084], device='cuda:0') tensor([76.8315], device='cuda:0')
33333 tensor([80.], device='cuda:0') tensor([-4.2726], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-84.2726], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([70.2032], device='cuda:0') tensor([-4.2726], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-74.4758], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.1244], device='cuda:0') tensor([-4.2726], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-81.3970], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.4274], device='cuda:0') tensor([-4.2726], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-81.7000], device='cuda:0', grad_fn=<SubBackward0>)
epoch 4,  actor_loss: -2732.5032,  critic_loss: 173962.5156, cost_time: 0.5096, best_solution: 0,od: 3.9737, eqity: 4.7640,rad: 18.1553
tensor([76.8315], device='cuda:0') tensor([76.1888], device='cuda:0')
33333 tensor([74.8407], device='cuda:0') tensor([139.4340], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([64.5933], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.3022], device='cuda:0') tensor([139.4340], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([60.1319], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([76.2258], device='cuda:0') tensor([139.4340], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([63.2082], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([75.9799], device='cuda:0') tensor([139.4340], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([63.4541], device='cuda:0', grad_fn=<SubBackward0>)
epoch 5,  actor_loss: 2005.2874,  critic_loss: 67507.8281, cost_time: 0.4334, best_solution: 0,od: 3.2685, eqity: 4.2661,rad: 12.4848
33333 tensor([80.], device='cuda:0') tensor([84.2218], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([4.2218], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([80.], device='cuda:0') tensor([84.2218], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([4.2218], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([76.9311], device='cuda:0') tensor([84.2218], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([7.2907], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([75.8541], device='cuda:0') tensor([84.2218], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([8.3677], device='cuda:0', grad_fn=<SubBackward0>)
epoch 6,  actor_loss: 150.8704,  critic_loss: 2335.9929, cost_time: 0.3780, best_solution: 0,od: 0.8079, eqity: 2.2546,rad: 14.9777
33333 tensor([77.6120], device='cuda:0') tensor([79.0034], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([1.3914], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.4776], device='cuda:0') tensor([79.0034], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-0.4742], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.0669], device='cuda:0') tensor([79.0034], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([1.9365], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.8706], device='cuda:0') tensor([79.0034], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([1.1328], device='cuda:0', grad_fn=<SubBackward0>)
epoch 7,  actor_loss: 27.9747,  critic_loss: 2223.1467, cost_time: 0.3673, best_solution: 0,od: 1.5836, eqity: 2.4915,rad: 23.0867
33333 tensor([78.0581], device='cuda:0') tensor([74.6155], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-3.4426], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.4561], device='cuda:0') tensor([74.6155], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-4.8406], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([74.5274], device='cuda:0') tensor([74.6155], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([0.0881], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([78.2280], device='cuda:0') tensor([74.6155], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-3.6125], device='cuda:0', grad_fn=<SubBackward0>)
epoch 8,  actor_loss: -75.8320,  critic_loss: 970.7681, cost_time: 0.4347, best_solution: 0,od: 1.8677, eqity: 3.0408,rad: 14.9777
33333 tensor([80.], device='cuda:0') tensor([75.3686], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-4.6314], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([69.8294], device='cuda:0') tensor([75.3686], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([5.5392], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([72.7785], device='cuda:0') tensor([75.3686], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([2.5901], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([80.], device='cuda:0') tensor([75.3686], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-4.6314], device='cuda:0', grad_fn=<SubBackward0>)
epoch 9,  actor_loss: 39.5474,  critic_loss: 1842.5398, cost_time: 0.3966, best_solution: 0,od: 3.9603, eqity: 5.4350,rad: 23.0867
tensor([76.1888], device='cuda:0') tensor([75.6520], device='cuda:0')
33333 tensor([79.0460], device='cuda:0') tensor([70.1205], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-8.9255], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([80.], device='cuda:0') tensor([70.1205], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-9.8795], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.0879], device='cuda:0') tensor([70.1205], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-8.9674], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([80.], device='cuda:0') tensor([70.1205], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-9.8795], device='cuda:0', grad_fn=<SubBackward0>)
epoch 10,  actor_loss: -182.9384,  critic_loss: 557.5067, cost_time: 0.3241, best_solution: 0,od: 0.1994, eqity: 0.5832,rad: 6.8686
33333 tensor([79.4035], device='cuda:0') tensor([72.6303], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-6.7732], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.5957], device='cuda:0') tensor([72.6303], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-6.9654], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([78.5728], device='cuda:0') tensor([72.6303], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-5.9425], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([80.], device='cuda:0') tensor([72.6303], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-7.3697], device='cuda:0', grad_fn=<SubBackward0>)
epoch 11,  actor_loss: -158.1482,  critic_loss: 626.9860, cost_time: 0.3345, best_solution: 0,od: 0.5004, eqity: 0.7588,rad: 12.4848
33333 tensor([69.9713], device='cuda:0') tensor([77.1591], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([7.1878], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([75.8594], device='cuda:0') tensor([77.1591], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([1.2997], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([76.5670], device='cuda:0') tensor([77.1591], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([0.5921], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.6136], device='cuda:0') tensor([77.1591], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-2.4546], device='cuda:0', grad_fn=<SubBackward0>)
epoch 12,  actor_loss: 85.0910,  critic_loss: 2068.8206, cost_time: 0.4081, best_solution: 0,od: 2.9297, eqity: 5.6215,rad: 23.0867
tensor([75.6520], device='cuda:0') tensor([75.5028], device='cuda:0')
33333 tensor([73.9985], device='cuda:0') tensor([77.6620], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([3.6635], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.2474], device='cuda:0') tensor([77.6620], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([0.4146], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.2996], device='cuda:0') tensor([77.6620], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([0.3624], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([76.0751], device='cuda:0') tensor([77.6620], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([1.5868], device='cuda:0', grad_fn=<SubBackward0>)
epoch 13,  actor_loss: 53.9687,  critic_loss: 1102.4486, cost_time: 0.3752, best_solution: 0,od: 4.5507, eqity: 4.8061,rad: 14.7136
33333 tensor([78.9320], device='cuda:0') tensor([76.3506], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-2.5814], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([74.1227], device='cuda:0') tensor([76.3506], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([2.2279], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([76.1658], device='cuda:0') tensor([76.3506], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([0.1848], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.1148], device='cuda:0') tensor([76.3506], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-0.7642], device='cuda:0', grad_fn=<SubBackward0>)
epoch 14,  actor_loss: 4.7506,  critic_loss: 2613.1191, cost_time: 0.3964, best_solution: 0,od: 1.6871, eqity: 4.2702,rad: 26.2644
33333 tensor([76.0167], device='cuda:0') tensor([73.9871], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-2.0296], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.6833], device='cuda:0') tensor([73.9871], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-3.6962], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([80.], device='cuda:0') tensor([73.9871], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-6.0129], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([72.2041], device='cuda:0') tensor([73.9871], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([1.7830], device='cuda:0', grad_fn=<SubBackward0>)
epoch 15,  actor_loss: -53.1062,  critic_loss: 1953.8954, cost_time: 0.4042, best_solution: 0,od: 3.8217, eqity: 4.4050,rad: 28.7029
33333 tensor([79.2411], device='cuda:0') tensor([69.3798], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-9.8612], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([76.3577], device='cuda:0') tensor([69.3798], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-6.9778], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([74.5622], device='cuda:0') tensor([69.3798], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-5.1824], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([80.], device='cuda:0') tensor([69.3798], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-10.6202], device='cuda:0', grad_fn=<SubBackward0>)
epoch 16,  actor_loss: -196.3566,  critic_loss: 1309.8210, cost_time: 0.3880, best_solution: 0,od: 2.9763, eqity: 3.0747,rad: 14.9777
33333 tensor([79.0554], device='cuda:0') tensor([68.3508], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-10.7046], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.7420], device='cuda:0') tensor([68.3508], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-11.3912], device='cuda:0', grad_fn=<SubBackward0>)
Traceback (most recent call last):
  File "/home/liqing/MORL/Metro-Line/metro.py", line 802, in <module>
    train_vrp(args)
  File "/home/liqing/MORL/Metro-Line/metro.py", line 672, in train_vrp
    train(actor, critic, allowed_station, static_size=STATIC_SIZE, **kwargs)
  File "/home/liqing/MORL/Metro-Line/metro.py", line 446, in train
    actor_loss.backward()
  File "/home/liqing/anaconda3/envs/morl/lib/python3.10/site-packages/torch/_tensor.py", line 492, in backward
    torch.autograd.backward(
  File "/home/liqing/anaconda3/envs/morl/lib/python3.10/site-packages/torch/autograd/__init__.py", line 251, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
33333 tensor([72.7861], device='cuda:0') tensor([68.3508], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-4.4353], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([72.8465], device='cuda:0') tensor([68.3508], device='cuda:0', grad_fn=<MaxBackward0>)
tensor([-4.4957], device='cuda:0', grad_fn=<SubBackward0>)