tensor(73712.)
epoch 0,  actor_loss: 84.5513,  critic_loss: 8.2702, cost_time: 1.2387, best_solution: 0,od: 2.8409, eqity: 5.7169,rad: 23.2819
2.840901218354702 5.716880597174168 23.281877040863037
epoch 1,  actor_loss: -121.3096,  critic_loss: 18.8517, cost_time: 0.7194, best_solution: [5.172597408294678],od: 3.4196, eqity: 6.9233,rad: 23.2819
3.419551642611623 6.923255503177643 23.281877040863037
epoch 2,  actor_loss: -13.8463,  critic_loss: 1.3035, cost_time: 0.7462, best_solution: [5.756155014038086],od: 1.8521, eqity: 2.3075,rad: 21.8403
epoch 3,  actor_loss: 211.5880,  critic_loss: 48.7495, cost_time: 0.6703, best_solution: [5.756155014038086],od: 1.4719, eqity: 3.4368,rad: 12.5120
epoch 4,  actor_loss: 135.3022,  critic_loss: 26.8554, cost_time: 0.6986, best_solution: [5.756155014038086],od: 1.0188, eqity: 2.3144,rad: 14.9777
epoch 5,  actor_loss: 14.3160,  critic_loss: 0.3049, cost_time: 0.7395, best_solution: [5.756155014038086],od: 0.3669, eqity: 2.0857,rad: 9.6767
epoch 6,  actor_loss: -13.8818,  critic_loss: 8.4036, cost_time: 0.8284, best_solution: [5.756155014038086],od: 3.5259, eqity: 5.8804,rad: 28.9252
3.52587266638875 5.880399569869041 28.925222396850586
epoch 7,  actor_loss: -61.3355,  critic_loss: 13.2987, cost_time: 0.6410, best_solution: [6.301260471343994],od: 1.7779, eqity: 3.8343,rad: 15.3201
epoch 8,  actor_loss: -45.0702,  critic_loss: 5.1341, cost_time: 0.6484, best_solution: [6.301260471343994],od: 0.8049, eqity: 2.2459,rad: 14.1191
epoch 9,  actor_loss: 46.5040,  critic_loss: 7.4769, cost_time: 0.6710, best_solution: [6.301260471343994],od: 2.1617, eqity: 4.2931,rad: 14.9777
epoch 10,  actor_loss: 59.6619,  critic_loss: 6.6644, cost_time: 0.6790, best_solution: [6.301260471343994],od: 2.2116, eqity: 3.9555,rad: 20.6210
epoch 11,  actor_loss: -10.2425,  critic_loss: 0.9767, cost_time: 0.7897, best_solution: [6.301260471343994],od: 0.9350, eqity: 2.0899,rad: 12.4848
epoch 12,  actor_loss: 42.8544,  critic_loss: 3.9133, cost_time: 0.7825, best_solution: [6.301260471343994],od: 1.8940, eqity: 4.5388,rad: 9.6767
epoch 13,  actor_loss: 34.7654,  critic_loss: 3.7704, cost_time: 0.8608, best_solution: [6.301260471343994],od: 2.1349, eqity: 6.2843,rad: 19.3746
epoch 14,  actor_loss: -41.5745,  critic_loss: 3.7639, cost_time: 0.6552, best_solution: [6.301260471343994],od: 0.9197, eqity: 3.1217,rad: 15.1728
epoch 15,  actor_loss: -13.5510,  critic_loss: 3.9891, cost_time: 0.7343, best_solution: [6.301260471343994],od: 1.8944, eqity: 3.4634,rad: 22.2098
epoch 16,  actor_loss: 38.9424,  critic_loss: 9.3610, cost_time: 0.5743, best_solution: [6.301260471343994],od: 2.4348, eqity: 3.4708,rad: 16.5665
[34m[1mwandb[39m[22m: 429 encountered (Filestream rate limit exceeded, retrying in 2.0 seconds.), retrying request
[34m[1mwandb[39m[22m: 429 encountered (Filestream rate limit exceeded, retrying in 4.1 seconds.), retrying request
[34m[1mwandb[39m[22m: 429 encountered (Filestream rate limit exceeded, retrying in 8.1 seconds.), retrying request
epoch 17,  actor_loss: -25.2938,  critic_loss: 1.5110, cost_time: 0.6530, best_solution: [6.301260471343994],od: 1.0921, eqity: 4.3075,rad: 14.9777
epoch 18,  actor_loss: 43.1925,  critic_loss: 2.8615, cost_time: 0.7973, best_solution: [6.301260471343994],od: 2.7023, eqity: 6.8714,rad: 35.5927
2.702260198071599 6.87138369679451 35.59267592430115
epoch 19,  actor_loss: -13.4833,  critic_loss: 1.1806, cost_time: 0.6692, best_solution: [6.408214569091797],od: 0.8749, eqity: 2.2614,rad: 13.7312
epoch 20,  actor_loss: 53.3686,  critic_loss: 4.1645, cost_time: 0.8054, best_solution: [6.408214569091797],od: 2.8180, eqity: 7.1968,rad: 24.2173
epoch 21,  actor_loss: 26.5814,  critic_loss: 3.9133, cost_time: 0.7128, best_solution: [6.408214569091797],od: 1.7501, eqity: 4.4852,rad: 16.5665
epoch 22,  actor_loss: 26.9566,  critic_loss: 3.4286, cost_time: 0.7409, best_solution: [6.408214569091797],od: 2.5511, eqity: 5.9217,rad: 16.5665
epoch 23,  actor_loss: -19.4975,  critic_loss: 5.2716, cost_time: 0.6416, best_solution: [6.408214569091797],od: 1.4180, eqity: 2.4103,rad: 14.2833
epoch 24,  actor_loss: -1.3687,  critic_loss: 7.6655, cost_time: 0.7333, best_solution: [6.408214569091797],od: 2.5572, eqity: 4.8321,rad: 20.6210
epoch 25,  actor_loss: -52.2715,  critic_loss: 4.0116, cost_time: 0.7747, best_solution: [6.408214569091797],od: 1.2689, eqity: 3.3934,rad: 10.9231
epoch 26,  actor_loss: -12.8103,  critic_loss: 2.7246, cost_time: 0.6499, best_solution: [6.408214569091797],od: 1.9862, eqity: 4.8031,rad: 19.0322
epoch 27,  actor_loss: -16.1016,  critic_loss: 1.2807, cost_time: 0.7295, best_solution: [6.408214569091797],od: 1.1119, eqity: 3.2743,rad: 9.6767
epoch 28,  actor_loss: -14.4250,  critic_loss: 0.5807, cost_time: 0.5727, best_solution: [6.408214569091797],od: 0.4014, eqity: 1.8463,rad: 6.8686
epoch 29,  actor_loss: 98.2736,  critic_loss: 12.1628, cost_time: 0.6610, best_solution: [6.408214569091797],od: 3.2168, eqity: 4.8395,rad: 28.7301
epoch 30,  actor_loss: 40.5690,  critic_loss: 3.9477, cost_time: 0.7226, best_solution: [6.408214569091797],od: 1.7108, eqity: 3.7401,rad: 18.3378
epoch 31,  actor_loss: 17.3014,  critic_loss: 1.8562, cost_time: 0.6056, best_solution: [6.408214569091797],od: 0.9881, eqity: 2.3852,rad: 6.8686
epoch 32,  actor_loss: 31.8799,  critic_loss: 6.3029, cost_time: 0.6404, best_solution: [6.408214569091797],od: 1.5342, eqity: 2.9957,rad: 12.5120
epoch 33,  actor_loss: 15.2560,  critic_loss: 0.7713, cost_time: 0.8184, best_solution: [6.408214569091797],od: 1.1903, eqity: 4.6048,rad: 17.7858
epoch 34,  actor_loss: 35.6915,  critic_loss: 5.3925, cost_time: 0.7244, best_solution: [6.408214569091797],od: 2.6826, eqity: 4.9923,rad: 23.7987
epoch 35,  actor_loss: -67.9890,  critic_loss: 5.7156, cost_time: 0.6900, best_solution: [6.408214569091797],od: 0.8669, eqity: 3.5851,rad: 14.9777
epoch 36,  actor_loss: -71.0255,  critic_loss: 7.9351, cost_time: 0.7272, best_solution: [6.408214569091797],od: 1.8463, eqity: 4.9379,rad: 21.8403
[34m[1mwandb[39m[22m: 429 encountered (Filestream rate limit exceeded, retrying in 17.3 seconds.), retrying request
epoch 37,  actor_loss: -67.6768,  critic_loss: 9.8261, cost_time: 0.5966, best_solution: [6.408214569091797],od: 1.6022, eqity: 2.9894,rad: 14.4785
epoch 38,  actor_loss: -50.7014,  critic_loss: 5.9404, cost_time: 0.7277, best_solution: [6.408214569091797],od: 2.2562, eqity: 4.7381,rad: 17.2866
epoch 39,  actor_loss: -57.3967,  critic_loss: 3.8888, cost_time: 0.7987, best_solution: [6.408214569091797],od: 1.1063, eqity: 4.2095,rad: 10.9231
epoch 40,  actor_loss: 25.0979,  critic_loss: 5.9897, cost_time: 0.7971, best_solution: [6.408214569091797],od: 2.8903, eqity: 6.7110,rad: 24.6755
epoch 41,  actor_loss: 14.2881,  critic_loss: 2.8219, cost_time: 0.7401, best_solution: [6.408214569091797],od: 2.1393, eqity: 5.6502,rad: 20.1628
epoch 42,  actor_loss: 25.4227,  critic_loss: 3.5745, cost_time: 0.8503, best_solution: [6.408214569091797],od: 2.8255, eqity: 6.2824,rad: 25.8948
epoch 43,  actor_loss: -27.9751,  critic_loss: 2.6994, cost_time: 0.6465, best_solution: [6.408214569091797],od: 1.4374, eqity: 5.6940,rad: 10.9231
epoch 44,  actor_loss: -9.6754,  critic_loss: 2.8227, cost_time: 0.7722, best_solution: [6.408214569091797],od: 2.3308, eqity: 4.0914,rad: 24.6755
epoch 45,  actor_loss: -26.8900,  critic_loss: 1.6669, cost_time: 0.7137, best_solution: [6.408214569091797],od: 1.2735, eqity: 3.9413,rad: 20.6210
epoch 46,  actor_loss: 56.2458,  critic_loss: 7.3233, cost_time: 0.7011, best_solution: [6.408214569091797],od: 2.9494, eqity: 5.1387,rad: 23.7987
epoch 47,  actor_loss: 57.2569,  critic_loss: 9.2090, cost_time: 0.7724, best_solution: [6.408214569091797],od: 3.4261, eqity: 7.8656,rad: 27.6788
epoch 48,  actor_loss: -22.0779,  critic_loss: 1.1119, cost_time: 0.8054, best_solution: [6.408214569091797],od: 1.0344, eqity: 3.3706,rad: 17.7858
epoch 49,  actor_loss: 24.9060,  critic_loss: 1.8251, cost_time: 0.6625, best_solution: [6.408214569091797],od: 2.4449, eqity: 5.2021,rad: 24.6755
epoch 50,  actor_loss: -4.5264,  critic_loss: 2.2376, cost_time: 0.6849, best_solution: [6.408214569091797],od: 1.3627, eqity: 4.5084,rad: 14.9777
epoch 51,  actor_loss: -4.8542,  critic_loss: 1.4440, cost_time: 0.5617, best_solution: [6.408214569091797],od: 1.3801, eqity: 3.2801,rad: 17.1223
epoch 52,  actor_loss: 33.3955,  critic_loss: 2.9261, cost_time: 0.7129, best_solution: [6.408214569091797],od: 2.5948, eqity: 4.3851,rad: 20.6210
epoch 53,  actor_loss: 50.3833,  critic_loss: 8.1368, cost_time: 0.7340, best_solution: [6.408214569091797],od: 2.9192, eqity: 4.2420,rad: 14.2833
epoch 54,  actor_loss: -2.4827,  critic_loss: 1.4699, cost_time: 0.6612, best_solution: [6.408214569091797],od: 1.4658, eqity: 2.8776,rad: 20.6210
epoch 55,  actor_loss: 24.1144,  critic_loss: 2.3816, cost_time: 0.7733, best_solution: [6.408214569091797],od: 2.2502, eqity: 4.0009,rad: 27.4836
epoch 56,  actor_loss: 6.2159,  critic_loss: 2.4770, cost_time: 0.6537, best_solution: [6.408214569091797],od: 1.9601, eqity: 3.9625,rad: 16.5665
epoch 57,  actor_loss: 13.2426,  critic_loss: 3.5280, cost_time: 0.7605, best_solution: [6.408214569091797],od: 2.3001, eqity: 6.1336,rad: 24.6755
epoch 58,  actor_loss: -24.5763,  critic_loss: 2.8310, cost_time: 0.7069, best_solution: [6.408214569091797],od: 1.6200, eqity: 2.5083,rad: 26.7893
[34m[1mwandb[39m[22m: 429 encountered (Filestream rate limit exceeded, retrying in 34.2 seconds.), retrying request
epoch 59,  actor_loss: -33.3227,  critic_loss: 2.6687, cost_time: 0.6908, best_solution: [6.408214569091797],od: 1.4516, eqity: 5.5182,rad: 19.0322
epoch 60,  actor_loss: 5.4216,  critic_loss: 1.8621, cost_time: 0.7356, best_solution: [6.408214569091797],od: 2.7348, eqity: 6.2874,rad: 28.7301
epoch 61,  actor_loss: -25.4412,  critic_loss: 2.6753, cost_time: 0.7255, best_solution: [6.408214569091797],od: 1.1758, eqity: 2.5079,rad: 17.9809
epoch 62,  actor_loss: 55.1227,  critic_loss: 5.4319, cost_time: 0.8240, best_solution: [6.408214569091797],od: 3.2663, eqity: 4.9364,rad: 20.5938
epoch 63,  actor_loss: 22.3615,  critic_loss: 2.6581, cost_time: 0.6959, best_solution: [6.408214569091797],od: 2.0199, eqity: 5.2489,rad: 18.1281
epoch 64,  actor_loss: 14.2115,  critic_loss: 2.2256, cost_time: 0.7786, best_solution: [6.408214569091797],od: 1.8070, eqity: 5.7317,rad: 21.8403
epoch 65,  actor_loss: 85.1753,  critic_loss: 10.8496, cost_time: 0.7487, best_solution: [6.408214569091797],od: 4.3577, eqity: 7.6766,rad: 27.3414
4.357726722955704 7.676630213856697 27.341359615325928
epoch 66,  actor_loss: 5.2374,  critic_loss: 4.0425, cost_time: 0.6975, best_solution: [6.987980842590332],od: 2.1628, eqity: 4.6025,rad: 15.1728
epoch 67,  actor_loss: 19.8350,  critic_loss: 5.7793, cost_time: 0.6604, best_solution: [6.987980842590332],od: 2.3245, eqity: 3.3685,rad: 24.8707
Traceback (most recent call last):
  File "/home/liqing/MORL/Metro-Line/metro.py", line 786, in <module>
    train_vrp(args)
  File "/home/liqing/MORL/Metro-Line/metro.py", line 656, in train_vrp
    train(actor, critic, allowed_station, static_size=STATIC_SIZE, **kwargs)
  File "/home/liqing/MORL/Metro-Line/metro.py", line 280, in train
    tour_idx, tour_logp = actor(static, dynamic, allowed_station,  args.station_num_lim, args.first, args.budget, args.initial_direct, args.line_unit_price, args.station_price, decoder_input=None, last_hh=None)
  File "/home/liqing/anaconda3/envs/morl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/liqing/anaconda3/envs/morl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/liqing/MORL/Metro-Line/metro_model.py", line 385, in forward
    vector_index_allow = self.forbid_overlap(ptr.data, vector_index_allow)
  File "/home/liqing/MORL/Metro-Line/metro_model.py", line 183, in forbid_overlap
    if pre_station in existing_lines[i]:
KeyboardInterrupt