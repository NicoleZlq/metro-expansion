
tensor(73712.)
epoch 0,  actor_loss: 240.0280,  critic_loss: 29.5344, cost_time: 8.6329, best_solution: 0,od: 4.1332, eqity: 5.7802,rad: 26.2644
tensor(100, device='cuda:0') tensor([75.3759], device='cuda:0')
epoch 1,  actor_loss: 17.9554,  critic_loss: 1.4153, cost_time: 6.1970, best_solution: 0,od: 3.5204, eqity: 4.5817,rad: 23.0867
epoch 2,  actor_loss: -315.1570,  critic_loss: 128.2128, cost_time: 6.3693, best_solution: 0,od: 2.9461, eqity: 4.5169,rad: 14.9777
epoch 3,  actor_loss: -250.1079,  critic_loss: 84.7082, cost_time: 5.7535, best_solution: 0,od: 1.6010, eqity: 3.9748,rad: 12.4848
epoch 4,  actor_loss: -91.0293,  critic_loss: 23.8465, cost_time: 5.3205, best_solution: 0,od: 3.4873, eqity: 4.4971,rad: 14.9777
epoch 5,  actor_loss: 10.5252,  critic_loss: 14.8343, cost_time: 6.5097, best_solution: 0,od: 1.8841, eqity: 4.7051,rad: 23.0867
epoch 6,  actor_loss: 155.0111,  critic_loss: 16.2528, cost_time: 7.1393, best_solution: 0,od: 2.1429, eqity: 6.2259,rad: 14.9777
tensor([75.3759], device='cuda:0') tensor([75.0193], device='cuda:0')
epoch 7,  actor_loss: 101.4235,  critic_loss: 17.4763, cost_time: 5.4076, best_solution: 0,od: 2.7228, eqity: 4.0836,rad: 23.0867
epoch 8,  actor_loss: 132.0045,  critic_loss: 16.0235, cost_time: 5.6572, best_solution: 0,od: 4.3370, eqity: 5.3609,rad: 34.3734
epoch 9,  actor_loss: 74.5632,  critic_loss: 14.6539, cost_time: 6.0899, best_solution: 0,od: 3.2334, eqity: 5.0069,rad: 26.2644
Traceback (most recent call last):
  File "/home/liqing/MORL/Metro-Line/metro.py", line 810, in <module>
    train_vrp(args)
  File "/home/liqing/MORL/Metro-Line/metro.py", line 677, in train_vrp
    train(actor, critic, allowed_station, static_size=STATIC_SIZE, **kwargs)
  File "/home/liqing/MORL/Metro-Line/metro.py", line 301, in train
    tour_idx, tour_logp = actor(static, dynamic, allowed_station,  args.station_num_lim, args.first, args.budget, args.initial_direct, args.line_unit_price, args.station_price, decoder_input=None, last_hh=None)
  File "/home/liqing/anaconda3/envs/morl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/liqing/anaconda3/envs/morl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/liqing/MORL/Metro-Line/metro_model.py", line 379, in forward
    self.direction_vector, vector_index_allow = self.vector_allow_fn(agent_current_index, grid_index1, exist_agent_last_grid, self.direction_vector)
  File "/home/liqing/MORL/Metro-Line/metro_vrp.py", line 623, in vector_allow
    direction_vector = self.agent_direct_vector(direction_vector, grid_index1, exist_agent_last_grid)
  File "/home/liqing/MORL/Metro-Line/metro_vrp.py", line 481, in agent_direct_vector
    elif torch.equal(deviation2, self.quadrant_left):
KeyboardInterrupt