1111 tensor([[94.9223],
        [89.5754],
        [60.6952]])
2222 tensor([[100.0959],
        [102.0040],
        [ 97.2870]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([71.6603], device='cuda:0') tensor([81.6032], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[99.7885],
        [98.3671],
        [93.1314]])
2222 tensor([[100.0959],
        [102.0040],
        [ 97.2870]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([78.6937], device='cuda:0') tensor([81.6032], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[89.3523],
        [83.9280],
        [47.9846]])
2222 tensor([[100.0959],
        [102.0040],
        [ 97.2870]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([67.1424], device='cuda:0') tensor([81.6032], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[95.6225],
        [96.5431],
        [59.1339]])
2222 tensor([[100.0959],
        [102.0040],
        [ 97.2870]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.2345], device='cuda:0') tensor([81.6032], device='cuda:0', grad_fn=<MaxBackward0>)
epoch 0,  actor_loss: 332.7043,  critic_loss: 4856.3442, cost_time: 1.1848, best_solution: 0,od: 5.0786, eqity: 7.8966,rad: 34.7637
tensor(100, device='cuda:0') tensor([73.6827], device='cuda:0')
1111 tensor([[99.9023],
        [99.3289],
        [93.1314]])
2222 tensor([[-929.2058],
        [-874.0328],
        [-990.1455]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.4631], device='cuda:0') tensor([-92.9206], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[99.4968],
        [95.3984],
        [93.1314]])
2222 tensor([[-929.2058],
        [-874.0328],
        [-990.1455]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([76.3187], device='cuda:0') tensor([-92.9206], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[100.0000],
        [ 99.6263],
        [ 93.1314]])
2222 tensor([[-929.2058],
        [-874.0328],
        [-990.1455]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.7010], device='cuda:0') tensor([-92.9206], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[95.5541],
        [93.6950],
        [60.6952]])
2222 tensor([[-929.2058],
        [-874.0328],
        [-990.1455]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([74.9560], device='cuda:0') tensor([-92.9206], device='cuda:0', grad_fn=<MaxBackward0>)
epoch 1,  actor_loss: -4472.1763,  critic_loss: 9446634.0000, cost_time: 0.2792, best_solution: 0,od: 1.2617, eqity: 2.9879,rad: 14.9777
1111 tensor([[ 99.7805],
        [100.0000],
        [ 93.1314]])
2222 tensor([[-45.2642],
        [-57.9110],
        [-28.4032]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([80.], device='cuda:0') tensor([-2.8403], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[95.2450],
        [94.1465],
        [93.1314]])
2222 tensor([[-45.2642],
        [-57.9110],
        [-28.4032]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([75.3172], device='cuda:0') tensor([-2.8403], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[98.5032],
        [93.2839],
        [93.1314]])
2222 tensor([[-45.2642],
        [-57.9110],
        [-28.4032]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([74.6271], device='cuda:0') tensor([-2.8403], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[ 99.6986],
        [100.0000],
        [ 93.1314]])
2222 tensor([[-45.2642],
        [-57.9110],
        [-28.4032]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([80.], device='cuda:0') tensor([-2.8403], device='cuda:0', grad_fn=<MaxBackward0>)
epoch 2,  actor_loss: -2338.0159,  critic_loss: 176729.1250, cost_time: 0.4545, best_solution: 0,od: 1.6932, eqity: 3.1424,rad: 6.8686
1111 tensor([[96.3605],
        [90.1738],
        [93.1314]])
2222 tensor([[293.7370],
        [307.5975],
        [313.9724]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([72.1390], device='cuda:0') tensor([246.0780], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[89.7423],
        [96.0539],
        [47.9846]])
2222 tensor([[293.7370],
        [307.5975],
        [313.9724]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([76.8432], device='cuda:0') tensor([246.0780], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[99.1600],
        [99.1240],
        [93.1314]])
2222 tensor([[293.7370],
        [307.5975],
        [313.9724]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.2992], device='cuda:0') tensor([246.0780], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[98.1794],
        [97.8722],
        [93.1314]])
2222 tensor([[293.7370],
        [307.5975],
        [313.9724]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([78.2977], device='cuda:0') tensor([246.0780], device='cuda:0', grad_fn=<MaxBackward0>)
epoch 3,  actor_loss: 6909.9365,  critic_loss: 412494.1875, cost_time: 0.5102, best_solution: 0,od: 4.1394, eqity: 4.1940,rad: 18.1553
1111 tensor([[94.4645],
        [88.0177],
        [60.6952]])
2222 tensor([[119.1403],
        [124.2700],
        [126.3893]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([70.4142], device='cuda:0') tensor([99.4160], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[97.8267],
        [94.3997],
        [93.1314]])
2222 tensor([[119.1403],
        [124.2700],
        [126.3893]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([75.5198], device='cuda:0') tensor([99.4160], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[ 99.7166],
        [100.0000],
        [ 93.1314]])
2222 tensor([[119.1403],
        [124.2700],
        [126.3893]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([80.], device='cuda:0') tensor([99.4160], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[85.7114],
        [89.9088],
        [93.1314]])
2222 tensor([[119.1403],
        [124.2700],
        [126.3893]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([71.9271], device='cuda:0') tensor([99.4160], device='cuda:0', grad_fn=<MaxBackward0>)
epoch 4,  actor_loss: 878.4061,  critic_loss: 10384.2891, cost_time: 0.4400, best_solution: 0,od: 5.5702, eqity: 6.9184,rad: 14.9777
1111 tensor([[99.3959],
        [99.2083],
        [78.8734]])
2222 tensor([[8.5270],
        [6.1169],
        [2.9390]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.3666], device='cuda:0') tensor([4.8935], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[ 99.9610],
        [100.0000],
        [ 93.1314]])
2222 tensor([[8.5270],
        [6.1169],
        [2.9390]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([80.], device='cuda:0') tensor([4.8935], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[95.0577],
        [92.4931],
        [60.6952]])
2222 tensor([[8.5270],
        [6.1169],
        [2.9390]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([73.9945], device='cuda:0') tensor([4.8935], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[99.7468],
        [96.4303],
        [93.1314]])
2222 tensor([[8.5270],
        [6.1169],
        [2.9390]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.1442], device='cuda:0') tensor([4.8935], device='cuda:0', grad_fn=<MaxBackward0>)
epoch 5,  actor_loss: -1501.1191,  critic_loss: 67551.9297, cost_time: 0.2532, best_solution: 0,od: 1.4597, eqity: 2.9671,rad: 18.5422
1111 tensor([[98.9779],
        [98.9321],
        [93.1314]])
2222 tensor([[84.2837],
        [81.4876],
        [79.8086]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.1457], device='cuda:0') tensor([65.1901], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[93.1032],
        [93.1897],
        [66.2500]])
2222 tensor([[84.2837],
        [81.4876],
        [79.8086]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([74.5518], device='cuda:0') tensor([65.1901], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[97.7740],
        [92.0646],
        [93.1314]])
2222 tensor([[84.2837],
        [81.4876],
        [79.8086]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([73.6516], device='cuda:0') tensor([65.1901], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[95.1001],
        [95.0777],
        [59.1339]])
2222 tensor([[84.2837],
        [81.4876],
        [79.8086]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([76.0621], device='cuda:0') tensor([65.1901], device='cuda:0', grad_fn=<MaxBackward0>)
epoch 6,  actor_loss: -345.8497,  critic_loss: 1921.8340, cost_time: 0.4096, best_solution: 0,od: 3.7612, eqity: 5.1840,rad: 22.0883
1111 tensor([[96.8393],
        [93.7265],
        [78.8734]])
2222 tensor([[99.9812],
        [99.9876],
        [99.9764]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([74.9812], device='cuda:0') tensor([79.9900], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[98.6410],
        [97.6759],
        [93.1314]])
2222 tensor([[99.9812],
        [99.9876],
        [99.9764]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([78.1408], device='cuda:0') tensor([79.9900], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[97.2906],
        [98.9068],
        [60.6952]])
2222 tensor([[99.9812],
        [99.9876],
        [99.9764]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.1255], device='cuda:0') tensor([79.9900], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[99.5565],
        [97.2590],
        [93.1314]])
2222 tensor([[99.9812],
        [99.9876],
        [99.9764]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.8072], device='cuda:0') tensor([79.9900], device='cuda:0', grad_fn=<MaxBackward0>)
epoch 7,  actor_loss: 78.3416,  critic_loss: 1596.1180, cost_time: 0.3815, best_solution: 0,od: 1.9182, eqity: 3.1079,rad: 18.5422
1111 tensor([[99.6632],
        [96.4881],
        [93.1314]])
2222 tensor([[99.8111],
        [99.8951],
        [99.8218]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.1905], device='cuda:0') tensor([79.9161], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[99.7887],
        [97.6597],
        [93.1314]])
2222 tensor([[99.8111],
        [99.8951],
        [99.8218]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([78.1277], device='cuda:0') tensor([79.9161], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[98.2435],
        [98.3536],
        [93.1314]])
2222 tensor([[99.8111],
        [99.8951],
        [99.8218]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([78.6829], device='cuda:0') tensor([79.9161], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[99.8765],
        [99.5032],
        [93.1314]])
2222 tensor([[99.8111],
        [99.8951],
        [99.8218]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.6025], device='cuda:0') tensor([79.9161], device='cuda:0', grad_fn=<MaxBackward0>)
epoch 8,  actor_loss: 38.1602,  critic_loss: 148.8821, cost_time: 0.3371, best_solution: 0,od: 0.6070, eqity: 1.9989,rad: 6.8686
1111 tensor([[99.7649],
        [97.3839],
        [93.1314]])
2222 tensor([[98.7319],
        [98.6650],
        [98.9957]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([77.9071], device='cuda:0') tensor([78.9320], device='cuda:0', grad_fn=<MaxBackward0>)
1111 tensor([[99.0300],
        [98.8382],
        [93.1314]])
2222 tensor([[98.7319],
        [98.6650],
        [98.9957]], device='cuda:0', grad_fn=<SubBackward0>)
33333 tensor([79.0705], device='cuda:0') tensor([78.9320], device='cuda:0', grad_fn=<MaxBackward0>)
Traceback (most recent call last):
  File "/home/liqing/MORL/Metro-Line/metro.py", line 805, in <module>
    train_vrp(args)
  File "/home/liqing/MORL/Metro-Line/metro.py", line 675, in train_vrp
    train(actor, critic, allowed_station, static_size=STATIC_SIZE, **kwargs)
  File "/home/liqing/MORL/Metro-Line/metro.py", line 289, in train
    reward_od = metro_vrp.reward_fn1(tour_idx_cpu, grid_num, agent_grid_list, line_full_tensor, line_station_list,
  File "/home/liqing/MORL/Metro-Line/metro_vrp.py", line 1056, in reward_fn1
    satisfied_od_mask = satisfied_od_mask.ge(0.5)
KeyboardInterrupt